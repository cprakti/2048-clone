<!DOCTYPE html>
<html lang="en">
<head>
  <!--
    normalize.css removes cross-browser differences in defaults, e.g.,
    differences in how form elements appear between Firefox and IE
    See: http://necolas.github.com/normalize.css/
  -->
  <link rel="stylesheet" href="/css/normalize.css">
  <!--
    application.css is where you put your styles
  -->
  <link rel="stylesheet" href="/css/application.css">

  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script src="js/mousetrap.js"></script>
  <script src="js/application.js"></script>

  <title>256!</title>
</head>
<body>

<p>Hey</p>

  <script type="text/javascript">


function Game() {
  this.board = [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]];
  this.setUpBoard();
  this.toString();
}

function randomNumber() {
  return Math.floor(Math.random()*4)
}

Game.prototype.setRand = function() {
  this.board[randomNumber()][randomNumber()] = 2
}

Game.prototype.secondRand = function() {
  var firstNum = randomNumber()
  var secondNum = randomNumber()
  if (this.board[firstNum][secondNum] === 0) {
    this.board[firstNum][secondNum] = 2
  } else {
    // console.log("Hey")
    this.secondRand()
  };
};

Game.prototype.setUpBoard = function() {
  this.setRand();
  this.secondRand();
}

Game.prototype.toString = function() {
  for ( i = 0; i< this.board.length; i++ ) {
    console.log(this.board[i])
 }
}

function nonZero(value) {
  return value > 0
}

Game.prototype.removeZeroes = function() {
  for ( i = 0; i < this.board.length; i++ ) {
    var filtered = this.board[i].filter(nonZero)
    this.board[i] = filtered
  };
};

Game.prototype.addZeroes = function() {
  for ( i = 0; i < this.board.length; i++ ) {
    while (this.board[i].length < 4) {
      this.board[i].push(0)
    };
  };
};

Game.prototype.combineLikeNumbers = function() {
    this.board.forEach(function(row){
      row.forEach(function(number, idx){
        if (number === row[idx+1]) {
          row[idx] = row[idx] + row[idx + 1]
          row.splice([idx + 1], 1)
        }
      });
    });
  };

function transpose(a) {
  return a[0].map(function (_, c) { return a.map(function (r) { return r[c]; }); });
}

Game.prototype.moveLeft = function() {
  this.removeZeroes();
  this.combineLikeNumbers();
  this.addZeroes();
  this.secondRand();
  this.toString();
}

Game.prototype.moveRight = function() {
  this.removeZeroes();
  this.board.forEach(function(row){ row.reverse() });
  this.combineLikeNumbers();
  this.addZeroes();
  this.board.forEach(function(row){ row.reverse() });
  this.secondRand();
  this.toString();
}

Game.prototype.moveUp = function() {
  this.board = transpose(this.board);
  // debugger;
  this.removeZeroes();
  this.combineLikeNumbers();
  this.addZeroes();
  this.board = transpose(this.board);
  this.secondRand();
  this.toString();
}

Game.prototype.moveDown = function() {
  this.board = transpose(this.board);
  this.board.forEach(function(row){ row.reverse() });
  // debugger;
  this.removeZeroes();
  this.combineLikeNumbers();
  this.addZeroes();
  this.board.forEach(function(row){ row.reverse() });
  this.board = transpose(this.board);
  this.secondRand();
  this.toString();
}



  </script>
</body>
</html>
